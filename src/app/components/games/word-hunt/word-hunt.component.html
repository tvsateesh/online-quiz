<div class="game-page-container">
  <div class="game-page-wrapper">
    
    <div class="game-content-card">
      
      <!-- Difficulty Selector -->
      <div class="difficulty-selector" *ngIf="!time">
        <h3 class="selector-title">
          <i class="fa fa-sliders"></i>
          Select Difficulty
        </h3>
        <div class="difficulty-buttons">
          <button *ngFor="let level of difficultyLevels" 
                  class="difficulty-btn"
                  [class.active]="difficulty === level.value"
                  (click)="setDifficulty(level.value)">
            <i class="fa fa-th"></i>
            <span class="difficulty-name">{{level.label}}</span>
            <span class="difficulty-info">10Ã—10 Grid</span>
          </button>
        </div>
      </div>

      <!-- Completion Message -->
      <div class="alert-message alert-success" *ngIf="completed">
        <i class="fa fa-star"></i>
        Congratulations! Found all words in {{endGameDuration}} minute(s)!
      </div>

      <!-- Game Statistics Dashboard -->
      <div class="stats-dashboard" *ngIf="gameHistory && gameHistory.length > 0 && !time">
        <div class="stats-header">
          <i class="fa fa-bar-chart"></i>
          <h3>Game History</h3>
          <span class="stats-count">({{gameHistory.length}} games)</span>
        </div>
        
        <div class="stats-table-wrapper">
          <table class="stats-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Difficulty</th>
                <th>Time (seconds)</th>
                <th>Score</th>
                <th>Result</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let game of gameHistory; let i = index" [class]="'result-' + game.result">
                <td class="rank">{{i + 1}}</td>
                <td class="difficulty">
                  <span class="difficulty-badge" [class]="'diff-' + game.difficulty">
                    {{game.difficulty | titlecase}}
                  </span>
                </td>
                <td class="time">{{game.time}}s</td>
                <td class="score">{{game.score}}</td>
                <td class="result">
                  <span class="result-badge" [class]="'badge-' + game.result">
                    {{game.result | titlecase}}
                  </span>
                </td>
                <td class="date">{{game.playedAt | date:'short'}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- Word Hunt Game Area -->
      <div class="word-hunt-container" *ngIf="time">
        
        <!-- Game Board - Left Side -->
        <div class="board-panel">
          <!-- Words List -->
          <div class="words-panel">
            <h3 class="panel-title">
              <i class="fa fa-list-ul"></i>
              Words to Find
            </h3>
            <div class="words-list">
              <div class="word-item" 
                   *ngFor="let wordData of wordsWithMeanings; let i = index"
                   [id]="wordData.word"
                   [class.found]="!solvedWords.includes(wordData.word)"
                   [title]="'Meaning: ' + wordData.meaning"
                   [attr.data-tooltip]="wordData.meaning">
                <div class="word-content">
                  <div class="word-header">
                    <span class="word-number">{{i + 1}}</span>
                    <span class="word-text">{{wordData.word}}</span>
                    <i class="fa fa-check-circle" *ngIf="!solvedWords.includes(wordData.word)"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Game Board -->
          <div class="board-wrapper">
            <table class="word-hunt-table">
              <tr *ngFor="let row of board; let i = index"> 
                <td *ngFor="let col of board[i]; let j = index" 
                    [attr.data-row]="i"
                    [attr.data-col]="j"
                    [class.selected]="isCellSelected(i, j)"
                    [class.done]="isCellInSolvedWord(i, j)"
                    (touchstart)="mouseDown($event)"
                    (mousedown)="mouseDown($event)"
                    (touchmove)="onMouseOver($event)"
                    (mouseover)="onMouseOver($event)" 
                    (touchend)="mouseUp($event)"
                    (mouseup)="mouseUp($event)">
                  {{col}}
                </td>
              </tr>
            </table>
          </div>
          <div class="board-hint">
            <i class="fa fa-info-circle"></i>
            <span>Click and drag to select words horizontally or vertically</span>
          </div>
        </div>

        <!-- Right Side: Status & Controls -->
        <div class="game-sidebar">
          <!-- Game Status -->
          <div class="game-status-panel">
            <div class="status-item">
              <i class="fa fa-trophy"></i>
              <div class="status-content">
                <span class="status-label">Found:</span>
                <span class="status-value">{{foundCount}}/{{hiddenWords.length}}</span>
              </div>
            </div>
            <div class="status-item">
              <i class="fa fa-clock-o"></i>
              <div class="status-content">
                <span class="status-label">Time:</span>
                <span class="status-value">{{time}}s</span>
              </div>
            </div>
            <div class="status-item">
              <i class="fa fa-signal"></i>
              <div class="status-content">
                <span class="status-label">Level:</span>
                <span class="status-value">{{difficulty | titlecase}}</span>
              </div>
            </div>
          </div>

          <!-- Game Action Buttons -->
          <div class="game-actions">
            <button class="game-btn game-btn-secondary" (click)="endGame()">
              <i class="fa fa-stop"></i> End Game
            </button>
            <button class="game-btn game-btn-success" (click)="downloadPDF()">
              <i class="fa fa-download"></i> Download PDF
            </button>
          </div>
        </div>
        
      </div>

      <!-- Game Instructions -->
      <div class="game-info" *ngIf="!time">
        <div class="info-card">
          <i class="fa fa-question-circle"></i>
          <h3>How to Play</h3>
          <p>Click and drag across letters to find the hidden words. Words can be horizontal or vertical in any direction.</p>
        </div>
        <div class="info-card">
          <i class="fa fa-lightbulb-o"></i>
          <h3>Tips</h3>
          <p>Look for patterns and common word beginnings. Words are highlighted in green when found!</p>
        </div>
      </div>
      
    </div>
    
  </div>
</div>

